{
  "version": 3,
  "sources": ["../../privategpt-sdk-web/utils-stream/index.js"],
  "sourcesContent": ["export class StreamingTextResponse extends Response {\n    constructor(res, init) {\n        let processedStream = res;\n        super(processedStream, {\n            ...init,\n            status: 200,\n            headers: {\n                'Content-Type': 'text/plain; charset=utf-8',\n                ...init?.headers,\n            },\n        });\n    }\n}\nasync function* streamable(stream) {\n    for await (let chunk of stream) {\n        yield chunk;\n    }\n}\nfunction createTransformer() {\n    const textEncoder = new TextEncoder();\n    return new TransformStream({\n        async transform(message, controller) {\n            controller.enqueue(textEncoder.encode(JSON.stringify(message)));\n        },\n    });\n}\nfunction readableFromAsyncIterable(iterable) {\n    let it = iterable[Symbol.asyncIterator]();\n    try {\n        return new ReadableStream({\n            async pull(controller) {\n                const { done, value } = await it.next();\n                if (done)\n                    controller.close();\n                else\n                    controller.enqueue(value);\n            },\n            async cancel(reason) {\n                await it.return?.(reason);\n            },\n        });\n    }\n    catch (error) {\n        console.error(error);\n    }\n    return new ReadableStream({});\n}\nexport const streamToReadableStream = (stream) => {\n    return readableFromAsyncIterable(streamable(stream)).pipeThrough(createTransformer());\n};\n"],
  "mappings": ";AAAO,IAAM,wBAAN,cAAoC,SAAS;AAAA,EAChD,YAAY,KAAK,MAAM;AACnB,QAAI,kBAAkB;AACtB,UAAM,iBAAiB;AAAA,MACnB,GAAG;AAAA,MACH,QAAQ;AAAA,MACR,SAAS;AAAA,QACL,gBAAgB;AAAA,QAChB,GAAG,6BAAM;AAAA,MACb;AAAA,IACJ,CAAC;AAAA,EACL;AACJ;AACA,gBAAgB,WAAW,QAAQ;AAC/B,iBAAe,SAAS,QAAQ;AAC5B,UAAM;AAAA,EACV;AACJ;AACA,SAAS,oBAAoB;AACzB,QAAM,cAAc,IAAI,YAAY;AACpC,SAAO,IAAI,gBAAgB;AAAA,IACvB,MAAM,UAAU,SAAS,YAAY;AACjC,iBAAW,QAAQ,YAAY,OAAO,KAAK,UAAU,OAAO,CAAC,CAAC;AAAA,IAClE;AAAA,EACJ,CAAC;AACL;AACA,SAAS,0BAA0B,UAAU;AACzC,MAAI,KAAK,SAAS,OAAO,aAAa,EAAE;AACxC,MAAI;AACA,WAAO,IAAI,eAAe;AAAA,MACtB,MAAM,KAAK,YAAY;AACnB,cAAM,EAAE,MAAM,MAAM,IAAI,MAAM,GAAG,KAAK;AACtC,YAAI;AACA,qBAAW,MAAM;AAAA;AAEjB,qBAAW,QAAQ,KAAK;AAAA,MAChC;AAAA,MACA,MAAM,OAAO,QAAQ;AArCjC;AAsCgB,gBAAM,QAAG,WAAH,4BAAY;AAAA,MACtB;AAAA,IACJ,CAAC;AAAA,EACL,SACO,OAAO;AACV,YAAQ,MAAM,KAAK;AAAA,EACvB;AACA,SAAO,IAAI,eAAe,CAAC,CAAC;AAChC;AACO,IAAM,yBAAyB,CAAC,WAAW;AAC9C,SAAO,0BAA0B,WAAW,MAAM,CAAC,EAAE,YAAY,kBAAkB,CAAC;AACxF;",
  "names": []
}
